# The Greatest Salesman - A Sales Pitch Practice Platform

**Deployed Link**: https://code.gwlee920.workers.dev  
**Demo Video**: https://youtu.be/0mJDF8kNC8Y

---

## Table of Contents

- [Problem Statement](#problem-statement)
- [Time Frame](#time-frame)
- [Key Features](#key-features)
- [Tech Stack](#tech-stack)
- [Components](#components)
- [System Design](#system-design)
- [Future Improvements](#future-improvements)
- [Getting Started](#getting-started)

---

## Problem Statement

I remember after a long hackathon, when it came time to present, I got nervous and didn't give an effective pitch about the product. This was frustratingâ€”I had built something great, but I couldn't communicate its value clearly. This experience made me realize that pitching and persuasion are skills that need practice, just like any other skill.

This realization inspired me to create a tool specifically for training salespeople, whose income is directly dependent on their ability to persuade and speak effectively. Sales professionals face rejection daily, handle objections constantly, and need to adapt their communication style to different customer personalitiesâ€”all skills that improve dramatically with deliberate practice.

This app prepares users for various real-world sales scenarios by providing:
- **Realistic customer personas** with distinct personalities, concerns, and buying behaviors
- **Interactive practice sessions** where users can pitch products and handle objections in a safe, low-stakes environment
- **Comprehensive AI-powered feedback** that analyzes communication style, persuasion techniques, objection handling, and closing ability
- **Detailed performance metrics** across multiple dimensions (empathy, clarity, assertiveness, persuasion, active listening, objection handling, closing ability, and flexibility)
- **Annotated transcripts** that highlight what worked well and what could be improved, with specific suggestions for each conversation segment

Whether you're a new sales rep preparing for your first pitch, a seasoned professional looking to refine your technique, or a sales manager wanting to train your team, this platform provides the structured practice and feedback needed to excel in sales conversations.

---
## Time Frame

This project was completed in **3 days**, and is meant to be a **Minimum Viable Product**.

---

## Key Features

### ğŸ¯ Interactive Practice Sessions
- **5 Predefined Sales Scenarios**: Practice with distinct customer personas including:
  - Friendly but indecisive buyers
  - Skeptical technical experts
  - Annoyed customers needing upsells
  - Hardball B2B negotiators
  - Job candidates (reverse sales)
- **Real-Time Chat Interface**: Engage in natural conversations with AI-powered customer personas
- **Scenario Information Sidebar**: Access customer profiles, product details, challenges, and success criteria during practice
- **Voice Input/Output**: Use browser-native Web Speech API for voice-to-text input and text-to-speech playback

### ğŸ¤– AI-Powered Customer Personas
- **Context-Aware Responses**: AI customers adapt their personality, concerns, and buying behavior based on the scenario
- **Conversation Memory**: AI remembers previous exchanges for natural, flowing conversations
- **Dynamic Persona Generation**: Each scenario uses customized prompts to create unique customer personalities
- **Powered by Llama 3.3 70B**: All customer responses generated by `@cf/meta/llama-3.3-70b-instruct-fp8-fast` on Cloudflare Workers AI

### ğŸ“Š Comprehensive Feedback Generation
- **3-Step AI Analysis Pipeline**:
  1. **Transcript Analyzer** (Llama 3.3 70B): High-level analysis, segmentation, and strength/weakness identification
  2. **Summary Analyzer** (Llama 3.3 70B): Overall performance ratings across 8 dimensions with narrative feedback
  3. **Detail Agent** (Llama 3.3 70B): Phrase-level annotations with specific suggestions for each conversation segment
- **8 Performance Dimensions**: Empathy, Clarity, Assertiveness, Persuasion, Active Listening, Objection Handling, Closing Ability, Flexibility
- **Annotated Transcripts**: Highlighted conversation segments with inline comments and improvement suggestions
- **Fast Feedback**: Complete analysis generated in 30-60 seconds

### ğŸ’¬ Interactive Feedback Chatbot
- **Contextual Q&A**: Ask questions about your feedback report (e.g., "Why do you say I wasn't personable enough?")
- **Personalized Guidance**: AI coach provides specific answers based on your performance analysis
- **Powered by Llama 3.3 70B**: Same model with specialized "feedback coach" prompt

### ğŸ“ˆ Progress Tracking & Analytics
- **Session History Dashboard**: View all past practice sessions with summaries and scores
- **Overall Statistics**: Average scores across all completed scenarios
- **Performance Trends**: Track improvement over time
- **Collapsible Session Details**: Expand any session to see conversation summary, performance analysis, and suggested improvements

### ğŸ¨ User Experience Features
- **Tabbed Report Navigation**: Easy access to Summary, Evaluation, and Annotations
- **Visual Score Display**: Progress bars for each performance dimension
- **Scenario Progression**: Cycle through all 5 scenarios with seamless navigation
- **Real-Time Streaming**: Server-Sent Events (SSE) for instant AI response display
- **Responsive Design**: Clean, modern UI built with React and Tailwind CSS

---

## Tech Stack

This application was built primarily using the **Cloudflare Developer Platform**, leveraging Cloudflare's edge computing infrastructure for fast, global performance and cost-effective scaling.

### Cloudflare Services

- **Cloudflare Workers** - Serverless compute platform that handles all API endpoints and business logic. Runs on Cloudflare's edge network for low latency worldwide. Processes chat requests, feedback generation workflows, and serves static assets.

- **Cloudflare Workers AI** - AI inference service that powers all AI features in the app. Uses **Llama 3.3 70B Instruct** (`@cf/meta/llama-3.3-70b-instruct-fp8-fast`) for:
  - Generating customer persona responses during chat
  - Analyzing transcripts (Step 1 of feedback pipeline)
  - Generating performance summaries (Step 2 of feedback pipeline)
  - Creating detailed annotations (Step 3 of feedback pipeline)
  - Powering the feedback explanation chatbot

- **Cloudflare D1 Database** - SQLite-based edge database for persistent storage. Stores conversations, messages, feedback reports, user scores, and scenario metadata. Provides ACID transactions and SQL query capabilities at the edge.

- **Cloudflare KV Namespaces** - Key-value storage for session state and temporary data. Used for lightweight session management and caching frequently accessed data.

- **Cloudflare Pages** - Static site hosting for the React frontend. Serves the built React application with global CDN distribution for fast page loads worldwide.

### Frontend Technologies

- **React 19** with **TypeScript** - Modern UI framework for building interactive, type-safe components. Powers the chat interface, report pages, and dashboard with component-based architecture.

- **Vite** - Fast build tool and development server. Provides hot module replacement for rapid frontend development and optimized production builds.

- **Tailwind CSS** - Utility-first CSS framework for styling. Enables rapid UI development with consistent design system and responsive layouts.

- **Marked** - Markdown parsing library for rendering AI-generated feedback reports. Converts markdown-formatted feedback into formatted HTML with proper styling.

- **Web Speech API** - Browser-native APIs for speech recognition (STT) and speech synthesis (TTS). Enables voice input for chat messages and audio playback of AI responses without external dependencies.

### Development & Deployment Tools

- **TypeScript** - Type-safe JavaScript development. Provides compile-time error checking, better IDE support, and improved code maintainability across both frontend and backend.

- **Wrangler** - Cloudflare CLI tool for local development and deployment. Handles Worker deployment, D1 migrations, KV operations, and local development server with hot reloading.

- **Vitest** - Unit testing framework with Cloudflare Workers support. Enables testing of Worker functions, memory managers, and session managers in a Workers-compatible environment.

### Architecture Benefits

This serverless, edge-first architecture ensures:
- **Low latency**: All components run on Cloudflare's global edge network
- **Cost-effective scaling**: Pay only for what you use, no idle server costs
- **Seamless integration**: All Cloudflare services work together natively
- **Global distribution**: Content and APIs served from 300+ data centers worldwide
- **No server management**: Fully serverless, no infrastructure to maintain

---

## Components

### Frontend Components

#### Pages
- **HomePage** (`src/frontend/pages/HomePage.tsx`): Central dashboard showing overall session statistics, average scores across all completed scenarios, and a collapsible history of past practice sessions
- **ChatPage** (`src/frontend/pages/ChatPage.tsx`): Main practice interface with scenario information sidebar, interactive chat with AI customer personas, and voice input/output capabilities
- **ReportPage** (`src/frontend/pages/ReportPage.tsx`): Comprehensive feedback report with tabbed navigation (Summary, Evaluation, Annotations) and an integrated chat assistant for asking questions about performance

#### Reusable Components
- **ScoreBar** (`src/frontend/components/ScoreBar.tsx`): Visual progress bar component for displaying performance scores
- **AnnotatedTranscript** (`src/frontend/components/AnnotatedTranscript.tsx`): Renders conversation transcripts with highlighted segments and inline feedback comments
- **TranscriptChatPanel** (`src/frontend/components/TranscriptChatPanel.tsx`): Chat interface for asking questions about feedback reports

#### Utilities
- **Parser** (`src/frontend/lib/parser.ts`): Parses AI-generated feedback reports into structured data (summary, feedback, suggestions, segments, scores)
- **Scenarios** (`src/frontend/lib/scenarios.ts`): Defines five predefined sales scenarios with customer profiles and product information

### Backend Components

#### AI Agents
- **Default Agent** (`src/workers/ai/defaultAgent.ts`): Handles live chat conversations with context-aware prompt selection and scenario-specific customer persona generation
- **Transcript Analyzer** (`src/workers/ai/transcriptAnalyzer.ts`): Performs high-level analysis of conversations, identifying strengths, weaknesses, and segmenting the transcript
- **Transcript Summary Analyzer** (`src/workers/ai/transcriptSummaryAnalyzer.ts`): Generates comprehensive summary analysis with performance ratings across multiple dimensions
- **Transcript Detail Agent** (`src/workers/ai/transcriptDetailAgent.ts`): Provides phrase-level feedback with annotations and suggestions for each conversation segment

#### Workflows
- **Feedback Orchestrator** (`src/workers/workflows/feedbackOrchestrator.ts`): Coordinates the 3-step feedback generation pipeline, chaining AI agents sequentially to produce comprehensive reports

#### Data Management
- **Memory Manager** (`src/workers/memory/memoryManager.ts`): Handles all D1 database operations (conversations, messages, feedback reports, user scores, scenarios)
- **Session Manager** (`src/workers/session/sessionManager.ts`): Manages KV namespace operations for session state and temporary data

#### Utilities
- **Stream Utils** (`src/workers/utils/streamUtils.ts`): Server-Sent Events (SSE) utilities for real-time streaming of AI responses
- **Retry Utils** (`src/workers/utils/retryUtils.ts`): Exponential backoff retry logic for handling transient API errors

#### Prompts & Configuration
- **Prompts** (`src/workers/lib/prompts.ts`): System prompts for different chat contexts (customer personas, feedback coach)
- **Scenario Prompts** (`src/workers/lib/scenarioPrompts.ts`): Dynamic customer persona prompts customized for each of the five predefined scenarios

### API Endpoints

- `POST /api/chat/stream`: Streams AI chat responses using SSE
- `POST /api/feedback`: Triggers feedback generation workflow
- `GET /api/report/:threadId`: Retrieves feedback report for a specific conversation
- `GET /api/sessions`: Returns list of all user sessions with summaries and scores

---

## System Design

### Architecture Overview

The application follows a **serverless, edge-first architecture** built entirely on Cloudflare's platform:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cloudflare Pages                          â”‚
â”‚  (React Frontend - Static Assets)                            â”‚
â”‚  - HomePage, ChatPage, ReportPage                           â”‚
â”‚  - Client-side routing                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ HTTPS
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Cloudflare Workers                           â”‚
â”‚  (API Endpoints & Business Logic)                            â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Chat Handler â”‚  â”‚Feedback      â”‚  â”‚Report        â”‚     â”‚
â”‚  â”‚              â”‚  â”‚Orchestrator  â”‚  â”‚Handler       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                 â”‚                  â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                  â”‚                 â”‚                         â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚         â”‚ Workers AI      â”‚  â”‚ D1 Database    â”‚            â”‚
â”‚         â”‚ (Llama 3.3)     â”‚  â”‚ (Conversations)â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                              â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚         â”‚ KV Namespaces (Session State)        â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow

#### 1. Practice Session Flow
```
User â†’ ChatPage â†’ POST /api/chat/stream
                    â†“
              Default Agent
                    â†“
              Workers AI (Llama 3.3)
                    â†“
              SSE Stream â†’ ChatPage
                    â†“
              Memory Manager â†’ D1 (Save messages)
```

#### 2. Feedback Generation Flow
```
User clicks "End Scenario" â†’ POST /api/feedback
                                â†“
                    Feedback Orchestrator
                                â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚                       â”‚
   Step 1:                  Step 2:                  Step 3:
Transcript Analyzer    Summary Analyzer        Detail Agent
        â”‚                       â”‚                       â”‚
   Workers AI              Workers AI            Workers AI
        â”‚                       â”‚                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†“
                    Combine Results â†’ Final Report
                                â†“
                    Memory Manager â†’ D1 (Save report & scores)
                                â†“
                    Return to Frontend â†’ ReportPage
```

### Key Design Decisions

1. **Edge-First Architecture**: All components run on Cloudflare's edge network, ensuring low latency globally
2. **Serverless Functions**: Workers handle API requests without managing servers or scaling concerns
3. **Sequential AI Pipeline**: Feedback generation uses a 3-step sequential workflow to ensure high-quality, contextual analysis
4. **Context-Aware Prompts**: Each scenario has customized customer persona prompts, ensuring realistic practice scenarios
5. **Persistent Memory**: D1 database stores conversation history, enabling context-aware responses and historical analysis
6. **Real-Time Streaming**: SSE enables real-time display of AI responses for better user experience
7. **Voice Integration**: Web Speech API provides native browser-based voice input/output without external dependencies

### Database Schema

**D1 Database Tables:**
- `conversations`: Thread metadata (resource_id, thread_id, timestamps)
- `messages`: Individual messages in conversations (role, content, timestamps)
- `feedback_reports`: Generated feedback reports (segmented_analysis, summary_analysis, detailed_feedback)
- `user_scores`: Performance scores per session (empathy, clarity, assertiveness, persuasion, active_listening, objection_handling, closing_ability, flexibility)
- `scenarios`: Scenario definitions and metadata

**KV Namespaces:**
- `SESSIONS`: Temporary session state and user preferences

---

## Future Improvements

### User Authentication & Multi-User Support
- **User accounts**: Implement authentication system (Cloudflare Access or OAuth) to enable user-specific data storage
- **User profiles**: Track progress over time, personal statistics, and achievement badges
- **Multi-user support**: Allow multiple users to practice independently with their own session history

### Team Management & Analytics Dashboard
- **Sales manager dashboard**: System where sales team managers can:
  - View reports of all team members' practice sessions
  - Track team-wide performance metrics and trends
  - Identify common areas for improvement across the team
  - Assign specific scenarios to team members for targeted practice

### Enhanced Features
- **Scenario marketplace**: Community-shared scenarios for different industries and use cases
- **Advanced analytics**: Detailed performance trends, improvement tracking, and personalized recommendations
- **Real-time coaching**: Live feedback during conversations (not just post-session)
- **Multi-language support**: Practice in different languages with localized customer personas

### Technical Enhancements
- **WebSocket support**: Real-time bidirectional communication for more interactive features
- **Caching layer**: KV-based caching for frequently accessed data to reduce D1 queries
- **Rate limiting**: Protect API endpoints from abuse
- **Analytics integration**: Cloudflare Analytics or custom analytics for usage tracking
- **A/B testing**: Test different prompt variations and UI improvements
- **Performance optimization**: Further reduce feedback generation time (currently 30-60 seconds)

---

## Getting Started

### Prerequisites
- Node.js 18+ and npm
- Cloudflare account
- Wrangler CLI (`npm install -g wrangler`)

### Local Development

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd code
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Set up Cloudflare resources**
   ```bash
   # Create D1 database
   npx wrangler d1 create ming-db
   
   # Create KV namespace
   npx wrangler kv namespace create SESSIONS
   
   # Run migrations
   npx wrangler d1 migrations apply ming-db --local
   ```

4. **Start development servers**
   ```bash
   # Terminal 1: Backend (Workers)
   npm run dev:remote  # Use :remote for AI features
   
   # Terminal 2: Frontend (Vite)
   npm run dev:frontend
   ```

5. **Access the application**
   - Frontend: http://localhost:5173
   - Backend API: http://localhost:8787

---






